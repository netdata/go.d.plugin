name: unbound
title: Unbound collector
overview:
  application:
    description: "[Unbound](https://nlnetlabs.nl/projects/unbound/about/) is a validating,
      recursive, and caching DNS resolver product\nfrom NLnet Labs.\n"
  collector:
    description: "This collector monitors one or more Unbound servers, depending on
      your configuration.\n"
setup:
  prerequisites:
    list:
      - title: Enable remote control interface
        description: "Set `control-enable` to yes in [unbound.conf](https://nlnetlabs.nl/documentation/unbound/unbound.conf).\n"
      - title: Check permissions and adjust if necessary
        description: "If using unix socket:\n\n- socket should be readable and writeable
          by `netdata` user\n\nIf using ip socket and TLS is disabled:\n\n- socket
          should be accessible via network\n\nIf TLS is enabled, in addition:\n\n
          - `control-key-file` should be readable by `netdata` user\n- `control-cert-file`
          should be readable by `netdata` user\n\nFor auto-detection parameters from
          `unbound.conf`:\n\n- `unbound.conf` should be readable by `netdata` user\n
          - if you have several configuration files (include feature) all of them
          should be readable by `netdata` user\n"
  configuration:
    options:
      description: "The following options can be defined globally: update_every, autodetection_retry.\n"
      folding:
        title: Config options
        enabled: true
      list:
        - name: update_every
          description: Data collection frequency.
          required: false
          default_value: 5
        - name: autodetection_retry
          description: Re-check interval in seconds. Zero means not to schedule re-check.
          required: false
          default_value: 0
        - name: address
          description: Server address in IP:PORT format.
          required: true
          default_value: 127.0.0.1:8953
        - name: timeout
          description: Connection/read/write/ssl handshake timeout.
          required: false
          default_value: 1
        - name: conf_path
          description: Absolute path to the unbound configuration file.
          required: false
          default_value: /etc/unbound/unbound.conf
        - name: cumulative_stats
          description: Statistics collection mode. Should have the same value as the
            `statistics-cumulative` parameter in the unbound configuration file.
          required: false
          default_value: /etc/unbound/unbound.conf
        - name: use_tls
          description: Whether to use TLS or not.
          required: false
          default_value: yes
        - name: tls_skip_verify
          description: Server certificate chain and hostname validation policy. Controls
            whether the client performs this check.
          required: false
          default_value: yes
        - name: tls_ca
          description: Certificate authority that client use when verifying server
            certificates.
          required: false
          default_value: ''
        - name: tls_cert
          description: Client tls certificate.
          required: false
          default_value: /etc/unbound/unbound_control.pem
        - name: tls_key
          description: Client tls key.
          required: false
          default_value: /etc/unbound/unbound_control.key
    examples:
      folding:
        title: Config
        enabled: true
      list:
        - name: Basic
          description: An example configuration.
          config: "jobs:\n  - name: local\n    address: 127.0.0.1:8953\n"
        - name: Unix socket
          description: Connecting through Unix socket.
          config: "jobs:\n  - name: socket\n    address: /var/run/unbound.sock\n"
        - name: Multi-instance
          description: "> **Note**: When you define multiple jobs, their names must
            be unique.\n\nLocal and remote instances.\n"
          config: "jobs:\n  - name: local\n    address: 127.0.0.1:8953\n\n  - name:
            remote\n    address: 203.0.113.11:8953\n"
    file:
      name: ''
troubleshooting:
  problems:
    list: []
metrics:
  folding:
    title: Metrics
    enabled: false
  description: ''
  availability: []
  scopes:
    - name: global
      description: These metrics refer to the entire monitored application.
      labels: []
      metrics:
        - name: unbound.queries
          description: Received Queries
          unit: queries
          dimensions:
            - name: queries
          chart_type: line
        - name: unbound.queries_ip_ratelimited
          description: Rate Limited Queries
          unit: queries
          dimensions:
            - name: ratelimited
          chart_type: line
        - name: unbound.dnscrypt_queries
          description: DNSCrypt Queries
          unit: queries
          dimensions:
            - name: crypted
            - name: cert
            - name: cleartext
            - name: malformed
          chart_type: line
        - name: unbound.cache
          description: Cache Statistics
          unit: events
          dimensions:
            - name: hits
            - name: miss
          chart_type: stacked
        - name: unbound.cache_percentage
          description: Cache Statistics Percentage
          unit: percentage
          dimensions:
            - name: hits
            - name: miss
          chart_type: stacked
        - name: unbound.prefetch
          description: Cache Prefetches
          unit: prefetches
          dimensions:
            - name: prefetches
          chart_type: line
        - name: unbound.expired
          description: Replies Served From Expired Cache
          unit: replies
          dimensions:
            - name: expired
          chart_type: line
        - name: unbound.zero_ttl_replies
          description: Replies Served From Expired Cache
          unit: replies
          dimensions:
            - name: zero_ttl
          chart_type: line
        - name: unbound.recursive_replies
          description: Replies That Needed Recursive Processing
          unit: replies
          dimensions:
            - name: recursive
          chart_type: line
        - name: unbound.recursion_time
          description: Time Spent On Recursive Processing
          unit: milliseconds
          dimensions:
            - name: avg
            - name: median
          chart_type: line
        - name: unbound.request_list_usage
          description: Request List Usage
          unit: queries
          dimensions:
            - name: avg
            - name: max
          chart_type: line
        - name: unbound.current_request_list_usage
          description: Current Request List Usage
          unit: queries
          dimensions:
            - name: all
            - name: users
          chart_type: area
        - name: unbound.request_list_jostle_list
          description: Request List Jostle List Events
          unit: queries
          dimensions:
            - name: overwritten
            - name: dropped
          chart_type: line
        - name: unbound.tcpusage
          description: TCP Handler Buffers
          unit: buffers
          dimensions:
            - name: usage
          chart_type: line
        - name: unbound.uptime
          description: Uptime
          unit: seconds
          dimensions:
            - name: time
          chart_type: line
        - name: unbound.cache_memory
          description: Cache Memory
          unit: KB
          dimensions:
            - name: message
            - name: rrset
            - name: dnscrypt_nonce
            - name: dnscrypt_shared_secret
          chart_type: stacked
        - name: unbound.mod_memory
          description: Module Memory
          unit: KB
          dimensions:
            - name: iterator
            - name: respip
            - name: validator
            - name: subnet
            - name: ipsec
          chart_type: stacked
        - name: unbound.mem_streamwait
          description: TCP and TLS Stream Waif Buffer Memory
          unit: KB
          dimensions:
            - name: streamwait
          chart_type: line
        - name: unbound.cache_count
          description: Cache Items Count
          unit: items
          dimensions:
            - name: infra
            - name: key
            - name: msg
            - name: rrset
            - name: dnscrypt_nonce
            - name: shared_secret
          chart_type: stacked
        - name: unbound.type_queries
          description: Queries By Type
          unit: queries
          dimensions:
            - name: a dimension per query type
          chart_type: stacked
        - name: unbound.class_queries
          description: Queries By Class
          unit: queries
          dimensions:
            - name: a dimension per query class
          chart_type: stacked
        - name: unbound.opcode_queries
          description: Queries By OpCode
          unit: queries
          dimensions:
            - name: a dimension per query opcode
          chart_type: stacked
        - name: unbound.flag_queries
          description: Queries By Flag
          unit: queries
          dimensions:
            - name: qr
            - name: aa
            - name: tc
            - name: rd
            - name: ra
            - name: z
            - name: ad
            - name: cd
          chart_type: stacked
        - name: unbound.rcode_answers
          description: Replies By RCode
          unit: replies
          dimensions:
            - name: a dimension per reply rcode
          chart_type: stacked
    - name: thread
      description: These metrics refer to threads.
      labels: []
      metrics:
        - name: unbound.thread_queries
          description: Thread Received Queries
          unit: queries
          dimensions:
            - name: queries
          chart_type: line
        - name: unbound.thread_queries_ip_ratelimited
          description: Thread Rate Limited Queries
          unit: queries
          dimensions:
            - name: ratelimited
          chart_type: line
        - name: unbound.thread_dnscrypt_queries
          description: Thread DNSCrypt Queries
          unit: queries
          dimensions:
            - name: crypted
            - name: cert
            - name: cleartext
            - name: malformed
          chart_type: line
        - name: unbound.thread_cache
          description: Cache Statistics
          unit: events
          dimensions:
            - name: hits
            - name: miss
          chart_type: line
        - name: unbound.thread_cache_percentage
          description: Cache Statistics Percentage
          unit: percentage
          dimensions:
            - name: hits
            - name: miss
          chart_type: line
        - name: unbound.thread_prefetch
          description: Cache Prefetches
          unit: prefetches
          dimensions:
            - name: prefetches
          chart_type: line
        - name: unbound.thread_expired
          description: Replies Served From Expired Cache
          unit: replies
          dimensions:
            - name: expired
          chart_type: line
        - name: unbound.thread_zero_ttl_replies
          description: Replies Served From Expired Cache
          unit: replies
          dimensions:
            - name: zero_ttl
          chart_type: line
        - name: unbound.thread_recursive_replies
          description: Replies That Needed Recursive Processing
          unit: replies
          dimensions:
            - name: recursive
          chart_type: line
        - name: unbound.thread_recursion_time
          description: Time Spent On Recursive Processing
          unit: milliseconds
          dimensions:
            - name: avg
            - name: median
          chart_type: line
        - name: unbound.thread_request_list_usage
          description: Time Spent On Recursive Processing
          unit: queries
          dimensions:
            - name: avg
            - name: max
          chart_type: line
        - name: unbound.thread_current_request_list_usage
          description: Current Request List Usage
          unit: queries
          dimensions:
            - name: all
            - name: users
          chart_type: line
        - name: unbound.thread_request_list_jostle_list
          description: Request List Jostle List Events
          unit: queries
          dimensions:
            - name: overwritten
            - name: dropped
          chart_type: line
        - name: unbound.thread_tcpusage
          description: TCP Handler Buffers
          unit: buffers
          dimensions:
            - name: usage
          chart_type: line
