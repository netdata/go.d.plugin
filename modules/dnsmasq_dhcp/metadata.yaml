name: dnsmasq_dhcp
title: Dnsmasq DHCP collector
overview:
  application:
    description: "[Dnsmasq](https://www.thekelleys.org.uk/dnsmasq/doc.html) is a lightweight,
      easy to configure DNS forwarder, designed to provide DNS (and optionally DHCP
      and TFTP) services to a small-scale network.\n"
  collector:
    description: "This collector monitors one or more Dnsmasq DHCP leases databases,
      depending on your configuration.\n\nBy default, it uses:\n\n- `/var/lib/misc/dnsmasq.leases`
      to read leases.\n- `/etc/dnsmasq.conf` to detect dhcp-ranges.\n- `/etc/dnsmasq.d`
      to find additional configurations.\n\nAll configured dhcp-ranges are detected
      automatically.\n"
setup:
  prerequisites:
    list: []
  configuration:
    options:
      description: "The following options can be defined globally: update_every, autodetection_retry.\n"
      folding:
        title: Config options
        enabled: true
      list:
        - name: update_every
          description: Data collection frequency.
          required: false
          default_value: 1
        - name: autodetection_retry
          description: Re-check interval in seconds. Zero means not to schedule re-check.
          required: false
          default_value: 0
        - name: leases_path
          description: Path to dnsmasq DHCP leases file.
          required: false
          default_value: /var/lib/misc/dnsmasq.leases
        - name: conf_path
          description: Path to dnsmasq configuration file.
          required: false
          default_value: /etc/dnsmasq.conf
        - name: conf_dir
          description: Path to dnsmasq configuration directory.
          required: false
          default_value: /etc/dnsmasq.d,.dpkg-dist,.dpkg-old,.dpkg-new
    examples:
      folding:
        title: Config
        enabled: true
      list:
        - name: Basic
          description: An example configuration.
          config: "jobs:\n  - name: dnsmasq_dhcp\n    leases_path: /var/lib/misc/dnsmasq.leases\n\
            \    conf_path: /etc/dnsmasq.conf\n    conf_dir: /etc/dnsmasq.d\n"
        - name: Pi-hole
          description: Dnsmasq DHCP on Pi-hole.
          config: "jobs:\n  - name: dnsmasq_dhcp\n    leases_path: /etc/pihole/dhcp.leases\n\
            \    conf_path: /etc/dnsmasq.conf\n    conf_dir: /etc/dnsmasq.d\n"
    file:
      name: ''
troubleshooting:
  problems:
    list: []
metrics:
  folding:
    title: Metrics
    enabled: false
  description: ''
  availability: []
  scopes:
    - name: global
      description: These metrics refer to the entire monitored application.
      labels: []
      metrics:
        - name: dnsmasq_dhcp.dhcp_ranges
          description: Number of DHCP Ranges
          unit: ranges
          dimensions:
            - name: ipv4
            - name: ipv6
          chart_type: stacked
        - name: dnsmasq_dhcp.dhcp_hosts
          description: Number of DHCP Hosts
          unit: hosts
          dimensions:
            - name: ipv4
            - name: ipv6
          chart_type: stacked
    - name: dhcp range
      description: These metrics refer to the DHCP range.
      labels:
        - name: dhcp_range
          description: DHCP range in `START_IP:END_IP` format
      metrics:
        - name: dnsmasq_dhcp.dhcp_range_utilization
          description: DHCP Range utilization
          unit: percentage
          dimensions:
            - name: used
          chart_type: line
        - name: dnsmasq_dhcp.dhcp_range_allocated_leases
          description: DHCP Range Allocated Leases
          unit: leases
          dimensions:
            - name: allocated
          chart_type: line
